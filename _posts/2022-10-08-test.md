---
layout: single
title: test
categories:
  - GitHub
tags:
  - [github, blog]
toc: true
toc_sticky: true
date: 2022-10-09
---

# 2장 데이터 핸들링

### 1절 판다스 데이터구조

series-1차원 배열구조
DataFrame-2차원 배열구조, 각 행은 인덱스를 가지며 각 열은 이름과 형식을 가진다.

### 2절 DataFrame 기본


```python
#패키지설치: !pip install pandas
```


```python
import pandas as pd
```


```python
# DataFrame 선언
import numpy as np
dataset = np.array([['kor', 70],['math', 80]])
# 방법1
df = pd.DataFrame(dataset, columns =['class', 'score'])
# 방법2
df = pd.DataFrame(data = [['kor', 70],['math',80]], columns = ['class','score'])
# 방법3
df = pd.DataFrame({'class':['kor','math'], 'score':[70,80]})
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>class</th>
      <th>score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>kor</td>
      <td>70</td>
    </tr>
    <tr>
      <th>1</th>
      <td>math</td>
      <td>80</td>
    </tr>
  </tbody>
</table>
</div>




```python
df1 = pd.DataFrame(data = [[50, 70],[60, 80]], columns = ['score1','score2'])
df1
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>score1</th>
      <th>score2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>50</td>
      <td>70</td>
    </tr>
    <tr>
      <th>1</th>
      <td>60</td>
      <td>80</td>
    </tr>
  </tbody>
</table>
</div>




```python
def add(df1):
    return math.ceil(df1['score1']+df1['score2'])

df1['합계'] = df1.apply(add, axis=1)
df1

#def add(df4):
#    return math.ceil(df4['DIS']+df4['INDUS'])

#df4['DnI'] = df4.apply(add, axis=1)
#df4
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>score1</th>
      <th>score2</th>
      <th>합계</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>50</td>
      <td>70</td>
      <td>120</td>
    </tr>
    <tr>
      <th>1</th>
      <td>60</td>
      <td>80</td>
      <td>140</td>
    </tr>
  </tbody>
</table>
</div>




```python
# Series 선언
#sr = pd.Series({'idx 1':value, 'idx2':value}, name ='class')
sr = pd.Series({'kor':70, 'math':80}, name ='class')
sr
```




    kor     70
    math    80
    Name: class, dtype: int64




```python
data = pd.read_csv(r'C:\Users\yooni\OneDrive\바탕 화면\ADP대비\ADP스터디\Boston_house.csv', na_values='NA', encoding ='utf8')
data.head(2)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AGE</th>
      <th>B</th>
      <th>RM</th>
      <th>CRIM</th>
      <th>DIS</th>
      <th>INDUS</th>
      <th>LSTAT</th>
      <th>NOX</th>
      <th>PTRATIO</th>
      <th>RAD</th>
      <th>ZN</th>
      <th>TAX</th>
      <th>CHAS</th>
      <th>Target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>65.2</td>
      <td>396.9</td>
      <td>6.575</td>
      <td>0.00632</td>
      <td>4.0900</td>
      <td>2.31</td>
      <td>4.98</td>
      <td>0.538</td>
      <td>15.3</td>
      <td>1</td>
      <td>18.0</td>
      <td>296</td>
      <td>0</td>
      <td>24.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>78.9</td>
      <td>396.9</td>
      <td>6.421</td>
      <td>0.02731</td>
      <td>4.9671</td>
      <td>7.07</td>
      <td>9.14</td>
      <td>0.469</td>
      <td>17.8</td>
      <td>2</td>
      <td>0.0</td>
      <td>242</td>
      <td>0</td>
      <td>21.6</td>
    </tr>
  </tbody>
</table>
</div>




```python
# csv 파일저장/ header-컬럼명, index-인덱스 저장여부 선택
df.to_csv('dfpractice.csv', header =True, index=True, encoding='utf8')
```


```python
# !pip install scikit-learn
from sklearn.datasets import load_iris
iris = load_iris()
iris = pd.DataFrame(iris.data, columns=iris.feature_names)
iris.tail(2)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal length (cm)</th>
      <th>sepal width (cm)</th>
      <th>petal length (cm)</th>
      <th>petal width (cm)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>148</th>
      <td>6.2</td>
      <td>3.4</td>
      <td>5.4</td>
      <td>2.3</td>
    </tr>
    <tr>
      <th>149</th>
      <td>5.9</td>
      <td>3.0</td>
      <td>5.1</td>
      <td>1.8</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 요약통계 정보확인
iris.info()
iris.describe()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 150 entries, 0 to 149
    Data columns (total 4 columns):
     #   Column             Non-Null Count  Dtype  
    ---  ------             --------------  -----  
     0   sepal length (cm)  150 non-null    float64
     1   sepal width (cm)   150 non-null    float64
     2   petal length (cm)  150 non-null    float64
     3   petal width (cm)   150 non-null    float64
    dtypes: float64(4)
    memory usage: 4.8 KB
    




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal length (cm)</th>
      <th>sepal width (cm)</th>
      <th>petal length (cm)</th>
      <th>petal width (cm)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>150.000000</td>
      <td>150.000000</td>
      <td>150.000000</td>
      <td>150.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>5.843333</td>
      <td>3.057333</td>
      <td>3.758000</td>
      <td>1.199333</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.828066</td>
      <td>0.435866</td>
      <td>1.765298</td>
      <td>0.762238</td>
    </tr>
    <tr>
      <th>min</th>
      <td>4.300000</td>
      <td>2.000000</td>
      <td>1.000000</td>
      <td>0.100000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>5.100000</td>
      <td>2.800000</td>
      <td>1.600000</td>
      <td>0.300000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>5.800000</td>
      <td>3.000000</td>
      <td>4.350000</td>
      <td>1.300000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>6.400000</td>
      <td>3.300000</td>
      <td>5.100000</td>
      <td>1.800000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>7.900000</td>
      <td>4.400000</td>
      <td>6.900000</td>
      <td>2.500000</td>
    </tr>
  </tbody>
</table>
</div>




```python
#index 수정 - list() 이용
```


```python
df.index
```




    RangeIndex(start=0, stop=2, step=1)




```python
list(df.index)
```




    [0, 1]




```python
df.index = ['A','B']
df.index
```




    Index(['A', 'B'], dtype='object')




```python
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>class</th>
      <th>score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <td>kor</td>
      <td>70</td>
    </tr>
    <tr>
      <th>B</th>
      <td>math</td>
      <td>80</td>
    </tr>
  </tbody>
</table>
</div>




```python
#DataFrame내의 열을 인덱스로 변경
df.set_index('class', drop=True, append=False, inplace=True)
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>score</th>
    </tr>
    <tr>
      <th>class</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>kor</th>
      <td>70</td>
    </tr>
    <tr>
      <th>math</th>
      <td>80</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 0부터 시작하는 인덱스로 재설정
df.reset_index(drop=False,inplace=True)
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>class</th>
      <th>score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>kor</td>
      <td>70</td>
    </tr>
    <tr>
      <th>1</th>
      <td>math</td>
      <td>80</td>
    </tr>
  </tbody>
</table>
</div>




```python
#컬럼명 확인 변경
iris.columns
```




    Index(['sepal length (cm)', 'sepal width (cm)', 'petal length (cm)',
           'petal width (cm)'],
          dtype='object')




```python
iris.columns = ['sepal length','sepal width','petal length','petal width']
iris.head(2)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal length</th>
      <th>sepal width</th>
      <th>petal length</th>
      <th>petal width</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.1</td>
      <td>3.5</td>
      <td>1.4</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.9</td>
      <td>3.0</td>
      <td>1.4</td>
      <td>0.2</td>
    </tr>
  </tbody>
</table>
</div>




```python
#컬럼명 내 특정문자를 다른문자로 대체
iris.columns = iris.columns.str.replace(' ','_')
iris.head(2)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal_length</th>
      <th>sepal_width</th>
      <th>petal_length</th>
      <th>petal_width</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.1</td>
      <td>3.5</td>
      <td>1.4</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.9</td>
      <td>3.0</td>
      <td>1.4</td>
      <td>0.2</td>
    </tr>
  </tbody>
</table>
</div>




```python
#데이터타입 확인
iris.dtypes
#또는 info()
```




    sepal_length    float64
    sepal_width     float64
    petal_length    float64
    petal_width     float64
    dtype: object




```python
#데이터타입 변경
iris['sepal_length'] = iris['sepal_width'].astype('int')
iris[['sepal_width','petal_length']] = \
iris[['sepal_width','petal_length']].astype('int')
iris.head(2)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal_length</th>
      <th>sepal_width</th>
      <th>petal_length</th>
      <th>petal_width</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3</td>
      <td>3</td>
      <td>1</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>3</td>
      <td>1</td>
      <td>0.2</td>
    </tr>
  </tbody>
</table>
</div>



### 3절 row/column 선택 추가 삭제


```python
from sklearn.datasets import load_iris
iris = load_iris()
iris = pd.DataFrame(iris.data, columns = iris.feature_names)
iris[1:4]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal length (cm)</th>
      <th>sepal width (cm)</th>
      <th>petal length (cm)</th>
      <th>petal width (cm)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>4.9</td>
      <td>3.0</td>
      <td>1.4</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.7</td>
      <td>3.2</td>
      <td>1.3</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.6</td>
      <td>3.1</td>
      <td>1.5</td>
      <td>0.2</td>
    </tr>
  </tbody>
</table>
</div>




```python
#row선택 - 슬라이싱
#슬라이싱-시퀀스 일부를 선택 [start:end], -는 마지막값부터 거꾸로 계산한 위치를 의미
s =[1,2,3,4,5]
s[1:2]
```




    [2]




```python
s[:-2]
```




    [1, 2, 3]




```python
s[:]
```




    [1, 2, 3, 4, 5]




```python
#column선택 ([]) 대괄호 두개 중첩!!
iris['sepal length (cm)'].head(2)
#Series형식 출력
```




    0    5.1
    1    4.9
    Name: sepal length (cm), dtype: float64




```python
iris[['sepal length (cm)', 'sepal width (cm)']].head(2)
#DataFrame형식 출력
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal length (cm)</th>
      <th>sepal width (cm)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.1</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.9</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
#row와 column모두 선택 - iloc/loc
#iloc - 위치기반
iris.iloc[1:3, 2:4]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>petal length (cm)</th>
      <th>petal width (cm)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>1.4</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.3</td>
      <td>0.2</td>
    </tr>
  </tbody>
</table>
</div>




```python
iris.iloc[[1,3,5], 1:3]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal width (cm)</th>
      <th>petal length (cm)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>3.0</td>
      <td>1.4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3.1</td>
      <td>1.5</td>
    </tr>
    <tr>
      <th>5</th>
      <td>3.9</td>
      <td>1.7</td>
    </tr>
  </tbody>
</table>
</div>




```python
iris.iloc[:, [True, False, True, False]]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal length (cm)</th>
      <th>petal length (cm)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.1</td>
      <td>1.4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.9</td>
      <td>1.4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.7</td>
      <td>1.3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.6</td>
      <td>1.5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.0</td>
      <td>1.4</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>145</th>
      <td>6.7</td>
      <td>5.2</td>
    </tr>
    <tr>
      <th>146</th>
      <td>6.3</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>147</th>
      <td>6.5</td>
      <td>5.2</td>
    </tr>
    <tr>
      <th>148</th>
      <td>6.2</td>
      <td>5.4</td>
    </tr>
    <tr>
      <th>149</th>
      <td>5.9</td>
      <td>5.1</td>
    </tr>
  </tbody>
</table>
<p>150 rows × 2 columns</p>
</div>




```python
#loc - 인덱스명, 컬럼명 사용
iris.loc[[1,2], ['sepal length (cm)','sepal width (cm)']]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal length (cm)</th>
      <th>sepal width (cm)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>4.9</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.7</td>
      <td>3.2</td>
    </tr>
  </tbody>
</table>
</div>




```python
#Value 변경
score = pd.DataFrame({'국어': [100, 80], '수학':[75, 90],
                     '영어':[90, 95]}, index = ['장화', '홍련'])
score
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>국어</th>
      <th>수학</th>
      <th>영어</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>장화</th>
      <td>100</td>
      <td>75</td>
      <td>90</td>
    </tr>
    <tr>
      <th>홍련</th>
      <td>80</td>
      <td>90</td>
      <td>95</td>
    </tr>
  </tbody>
</table>
</div>




```python
score.loc['홍련', '영어'] = 100
score['국어'] = score['국어'] - 5
score
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>국어</th>
      <th>수학</th>
      <th>영어</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>장화</th>
      <td>95</td>
      <td>75</td>
      <td>90</td>
    </tr>
    <tr>
      <th>홍련</th>
      <td>75</td>
      <td>90</td>
      <td>100</td>
    </tr>
  </tbody>
</table>
</div>




```python
#row추가- append
new_students = pd.DataFrame({'국어':[70,85], '수학':[65,100],
                            '영어':[95,65]}, index=['콩쥐', '팥쥐'])
score = score.append(new_students)
#series로 행주가 (name이 row name이 된다)
new_student1 = pd.Series({'국어':85, '수학':55, '영어':95}, name = '해님')
score = score.append(new_student1)
score
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>국어</th>
      <th>수학</th>
      <th>영어</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>장화</th>
      <td>95</td>
      <td>75</td>
      <td>90</td>
    </tr>
    <tr>
      <th>홍련</th>
      <td>75</td>
      <td>90</td>
      <td>100</td>
    </tr>
    <tr>
      <th>콩쥐</th>
      <td>70</td>
      <td>65</td>
      <td>95</td>
    </tr>
    <tr>
      <th>팥쥐</th>
      <td>85</td>
      <td>100</td>
      <td>65</td>
    </tr>
    <tr>
      <th>해님</th>
      <td>85</td>
      <td>55</td>
      <td>95</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 딕셔너리 {}로 행추가하면 ignore_index=True로 설정해준다 
# 단 기존 인덱스로 전부 사라지기 떄문에 주의!
new_student2 = {'국어':75, '수학':80, '영어':80}
score.append(new_student2, ignore_index = True)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>국어</th>
      <th>수학</th>
      <th>영어</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>95</td>
      <td>75</td>
      <td>90</td>
    </tr>
    <tr>
      <th>1</th>
      <td>75</td>
      <td>90</td>
      <td>100</td>
    </tr>
    <tr>
      <th>2</th>
      <td>70</td>
      <td>65</td>
      <td>95</td>
    </tr>
    <tr>
      <th>3</th>
      <td>85</td>
      <td>100</td>
      <td>65</td>
    </tr>
    <tr>
      <th>4</th>
      <td>85</td>
      <td>55</td>
      <td>95</td>
    </tr>
    <tr>
      <th>5</th>
      <td>75</td>
      <td>80</td>
      <td>80</td>
    </tr>
  </tbody>
</table>
</div>




```python
#column추가
science = [80, 70, 90, 85, 75]
score['과학'] = science
score['학년'] = 1
score
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>국어</th>
      <th>수학</th>
      <th>영어</th>
      <th>과학</th>
      <th>학년</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>장화</th>
      <td>95</td>
      <td>75</td>
      <td>90</td>
      <td>80</td>
      <td>1</td>
    </tr>
    <tr>
      <th>홍련</th>
      <td>75</td>
      <td>90</td>
      <td>100</td>
      <td>70</td>
      <td>1</td>
    </tr>
    <tr>
      <th>콩쥐</th>
      <td>70</td>
      <td>65</td>
      <td>95</td>
      <td>90</td>
      <td>1</td>
    </tr>
    <tr>
      <th>팥쥐</th>
      <td>85</td>
      <td>100</td>
      <td>65</td>
      <td>85</td>
      <td>1</td>
    </tr>
    <tr>
      <th>해님</th>
      <td>85</td>
      <td>55</td>
      <td>95</td>
      <td>75</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>




```python
#삭제 - drop
#inplace=Fales면 복사본으로 반환함
score.drop('장화', inplace=True)
score.drop(columns = ['과학', '학년'], inplace= True)
score
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>국어</th>
      <th>수학</th>
      <th>영어</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>홍련</th>
      <td>75</td>
      <td>90</td>
      <td>100</td>
    </tr>
    <tr>
      <th>콩쥐</th>
      <td>70</td>
      <td>65</td>
      <td>95</td>
    </tr>
    <tr>
      <th>팥쥐</th>
      <td>85</td>
      <td>100</td>
      <td>65</td>
    </tr>
    <tr>
      <th>해님</th>
      <td>85</td>
      <td>55</td>
      <td>95</td>
    </tr>
  </tbody>
</table>
</div>



### 4절 조건에 맞는 데이터 탐색 및 수정


```python
students = pd.DataFrame({'이름':['장화','홍련','콩쥐','팥쥐','해님','달님'],
                        '국어':[70,85,None,100,None,85],
                        '수학':[65,100,80,95,None,70]})
students[students['이름'] == '장화']
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>이름</th>
      <th>국어</th>
      <th>수학</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>장화</td>
      <td>70.0</td>
      <td>65.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
students[(students['국어']>=80) & (students['수학']>=80)]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>이름</th>
      <th>국어</th>
      <th>수학</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>홍련</td>
      <td>85.0</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>팥쥐</td>
      <td>100.0</td>
      <td>95.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
students.loc[6, '이름':'수학'] = ['별님', 50, 60]
students.loc[(students['국어']>=80)&(students['수학']>=80), '합격'] = 'Pass'
students.loc[students['합격']!='Pass', '합격'] = 'Fail'
students
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>이름</th>
      <th>국어</th>
      <th>수학</th>
      <th>합격</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>장화</td>
      <td>70.0</td>
      <td>65.0</td>
      <td>Fail</td>
    </tr>
    <tr>
      <th>1</th>
      <td>홍련</td>
      <td>85.0</td>
      <td>100.0</td>
      <td>Pass</td>
    </tr>
    <tr>
      <th>2</th>
      <td>콩쥐</td>
      <td>NaN</td>
      <td>80.0</td>
      <td>Fail</td>
    </tr>
    <tr>
      <th>3</th>
      <td>팥쥐</td>
      <td>100.0</td>
      <td>95.0</td>
      <td>Pass</td>
    </tr>
    <tr>
      <th>4</th>
      <td>해님</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Fail</td>
    </tr>
    <tr>
      <th>5</th>
      <td>달님</td>
      <td>85.0</td>
      <td>70.0</td>
      <td>Fail</td>
    </tr>
    <tr>
      <th>6</th>
      <td>별님</td>
      <td>50.0</td>
      <td>60.0</td>
      <td>Fail</td>
    </tr>
  </tbody>
</table>
</div>




```python
#조건에 따른 다른 값 - select()
condition_list = [(students['국어']>=90),
                 (students['국어']>=80)& (students['국어']<90),
                 (students['국어']>=70)& (students['국어']<80)]
choice_list = ['A', 'B', 'C']
students['점수'] = np.select(condition_list, choice_list, default='F')
students
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>이름</th>
      <th>국어</th>
      <th>수학</th>
      <th>합격</th>
      <th>점수</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>장화</td>
      <td>70.0</td>
      <td>65.0</td>
      <td>Fail</td>
      <td>C</td>
    </tr>
    <tr>
      <th>1</th>
      <td>홍련</td>
      <td>85.0</td>
      <td>100.0</td>
      <td>Pass</td>
      <td>B</td>
    </tr>
    <tr>
      <th>2</th>
      <td>콩쥐</td>
      <td>NaN</td>
      <td>80.0</td>
      <td>Fail</td>
      <td>F</td>
    </tr>
    <tr>
      <th>3</th>
      <td>팥쥐</td>
      <td>100.0</td>
      <td>95.0</td>
      <td>Pass</td>
      <td>A</td>
    </tr>
    <tr>
      <th>4</th>
      <td>해님</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Fail</td>
      <td>F</td>
    </tr>
    <tr>
      <th>5</th>
      <td>달님</td>
      <td>85.0</td>
      <td>70.0</td>
      <td>Fail</td>
      <td>B</td>
    </tr>
    <tr>
      <th>6</th>
      <td>별님</td>
      <td>50.0</td>
      <td>60.0</td>
      <td>Fail</td>
      <td>F</td>
    </tr>
  </tbody>
</table>
</div>




```python
#결측값 탐색 isna,isnull/notna,notnull
students.isna()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>이름</th>
      <th>국어</th>
      <th>수학</th>
      <th>합격</th>
      <th>점수</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>5</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>6</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>




```python
students.notna()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>이름</th>
      <th>국어</th>
      <th>수학</th>
      <th>합격</th>
      <th>점수</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>1</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>2</th>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>3</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>4</th>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>5</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>6</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div>




```python
#결측값 갯수 세기
#열합계 sum()
students.isna().sum()
```




    이름    0
    국어    2
    수학    1
    합격    0
    점수    0
    dtype: int64




```python
#행합계 sum(1)
students.isna().sum(1)
```




    0    0
    1    0
    2    1
    3    0
    4    2
    5    0
    6    0
    dtype: int64




```python
#결측값 포함된 모든 행 제거
students.dropna()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>이름</th>
      <th>국어</th>
      <th>수학</th>
      <th>합격</th>
      <th>점수</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>장화</td>
      <td>70.0</td>
      <td>65.0</td>
      <td>Fail</td>
      <td>C</td>
    </tr>
    <tr>
      <th>1</th>
      <td>홍련</td>
      <td>85.0</td>
      <td>100.0</td>
      <td>Pass</td>
      <td>B</td>
    </tr>
    <tr>
      <th>3</th>
      <td>팥쥐</td>
      <td>100.0</td>
      <td>95.0</td>
      <td>Pass</td>
      <td>A</td>
    </tr>
    <tr>
      <th>5</th>
      <td>달님</td>
      <td>85.0</td>
      <td>70.0</td>
      <td>Fail</td>
      <td>B</td>
    </tr>
    <tr>
      <th>6</th>
      <td>별님</td>
      <td>50.0</td>
      <td>60.0</td>
      <td>Fail</td>
      <td>F</td>
    </tr>
  </tbody>
</table>
</div>




```python
#결측값 아닌값이 4개보다 많은 행만 남기기
students.dropna(thresh=4)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>이름</th>
      <th>국어</th>
      <th>수학</th>
      <th>합격</th>
      <th>점수</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>장화</td>
      <td>70.0</td>
      <td>65.0</td>
      <td>Fail</td>
      <td>C</td>
    </tr>
    <tr>
      <th>1</th>
      <td>홍련</td>
      <td>85.0</td>
      <td>100.0</td>
      <td>Pass</td>
      <td>B</td>
    </tr>
    <tr>
      <th>2</th>
      <td>콩쥐</td>
      <td>NaN</td>
      <td>80.0</td>
      <td>Fail</td>
      <td>F</td>
    </tr>
    <tr>
      <th>3</th>
      <td>팥쥐</td>
      <td>100.0</td>
      <td>95.0</td>
      <td>Pass</td>
      <td>A</td>
    </tr>
    <tr>
      <th>5</th>
      <td>달님</td>
      <td>85.0</td>
      <td>70.0</td>
      <td>Fail</td>
      <td>B</td>
    </tr>
    <tr>
      <th>6</th>
      <td>별님</td>
      <td>50.0</td>
      <td>60.0</td>
      <td>Fail</td>
      <td>F</td>
    </tr>
  </tbody>
</table>
</div>




```python
#data.dropna(axis=0, how='any', thresh=None, subset=None, inplace=False)
#axis: 0 또는 'index'면 결측값 포함된 행 삭제// 1 또는 'columns'면 결측값 포함된 열 삭제
#how: 'any'-결측값 존재하는 모든행/열삭제, 'all'-모든값이 결측값일때 삭제
#subset: 어떤 레이블
#inplace: True-제자리 작업수행하고 None반환
```


```python
#결측값 대체-fillna
#data.fillna(value=None,method=None,axis=None, inplace=False,limit=None)
#value: 단일값 혹은 dict/Series/DataFrame형식으로 대체할 값을 직접 입력
#method: 'pad','ffill'이전 값으로 채우고 'backfill'/'bfill'은 다음에 오는 값으로 채움
#inplace=True면 원본데이터에 변경내용 적용
```


```python
health = pd.DataFrame({'연도':[17,18,19,20,21,22],
                      '키':[160,162,165,None,None,166],
                      '몸무게':[53,52,None,50,51,54],
                      '시력':[1.2,None,1.2,1.2,1.1,0.8],
                      '병결':[None,None,None,2,None,1]})
#0으로 채우기
health.fillna(0)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>연도</th>
      <th>키</th>
      <th>몸무게</th>
      <th>시력</th>
      <th>병결</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>17</td>
      <td>160.0</td>
      <td>53.0</td>
      <td>1.2</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>18</td>
      <td>162.0</td>
      <td>52.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>19</td>
      <td>165.0</td>
      <td>0.0</td>
      <td>1.2</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>20</td>
      <td>0.0</td>
      <td>50.0</td>
      <td>1.2</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>21</td>
      <td>0.0</td>
      <td>51.0</td>
      <td>1.1</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>22</td>
      <td>166.0</td>
      <td>54.0</td>
      <td>0.8</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
#평균으로 채우기
health.fillna(health.mean())
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>연도</th>
      <th>키</th>
      <th>몸무게</th>
      <th>시력</th>
      <th>병결</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>17</td>
      <td>160.00</td>
      <td>53.0</td>
      <td>1.2</td>
      <td>1.5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>18</td>
      <td>162.00</td>
      <td>52.0</td>
      <td>1.1</td>
      <td>1.5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>19</td>
      <td>165.00</td>
      <td>52.0</td>
      <td>1.2</td>
      <td>1.5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>20</td>
      <td>163.25</td>
      <td>50.0</td>
      <td>1.2</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>21</td>
      <td>163.25</td>
      <td>51.0</td>
      <td>1.1</td>
      <td>1.5</td>
    </tr>
    <tr>
      <th>5</th>
      <td>22</td>
      <td>166.00</td>
      <td>54.0</td>
      <td>0.8</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
health['병결'] = health['병결'].fillna(0)
health['몸무게']= health['몸무게'].fillna(health['몸무게'].mean())
health
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>연도</th>
      <th>키</th>
      <th>몸무게</th>
      <th>시력</th>
      <th>병결</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>17</td>
      <td>160.0</td>
      <td>53.0</td>
      <td>1.2</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>18</td>
      <td>162.0</td>
      <td>52.0</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>19</td>
      <td>165.0</td>
      <td>52.0</td>
      <td>1.2</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>20</td>
      <td>NaN</td>
      <td>50.0</td>
      <td>1.2</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>21</td>
      <td>NaN</td>
      <td>51.0</td>
      <td>1.1</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>22</td>
      <td>166.0</td>
      <td>54.0</td>
      <td>0.8</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
#결측값 바로 직전 값으로 대체
health.fillna(method ='pad', inplace = True)
health
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>연도</th>
      <th>키</th>
      <th>몸무게</th>
      <th>시력</th>
      <th>병결</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>17</td>
      <td>160.0</td>
      <td>53.0</td>
      <td>1.2</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>18</td>
      <td>162.0</td>
      <td>52.0</td>
      <td>1.2</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>19</td>
      <td>165.0</td>
      <td>52.0</td>
      <td>1.2</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>20</td>
      <td>165.0</td>
      <td>50.0</td>
      <td>1.2</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>21</td>
      <td>165.0</td>
      <td>51.0</td>
      <td>1.1</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>22</td>
      <td>166.0</td>
      <td>54.0</td>
      <td>0.8</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
#중복행 삭제-duplicates (series형식 출력)
health['키'].drop_duplicates()
```




    0    160.0
    1    162.0
    2    165.0
    5    166.0
    Name: 키, dtype: float64




```python
#set- 어떤값이 있는지 중복없이 확인 (tuple형식 출력)
set(health['키'])
```




    {160.0, 162.0, 165.0, 166.0}




```python
c= [1,2,2,3,4]
set(c)
```




    {1, 2, 3, 4}




```python
#여러컬럼에 대해서는 각 행을 하나의 객체로 보고 중복제거
health[['시력','병결']].drop_duplicates()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>시력</th>
      <th>병결</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.2</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.2</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.1</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.8</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>



### 5절 데이터 정렬


```python
#index의 내림차순, inplace=False면 복사본으로 정렬 수행
iris.sort_index(ascending=False, inplace=True)
iris.head(6)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal length (cm)</th>
      <th>sepal width (cm)</th>
      <th>petal length (cm)</th>
      <th>petal width (cm)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>149</th>
      <td>5.9</td>
      <td>3.0</td>
      <td>5.1</td>
      <td>1.8</td>
    </tr>
    <tr>
      <th>148</th>
      <td>6.2</td>
      <td>3.4</td>
      <td>5.4</td>
      <td>2.3</td>
    </tr>
    <tr>
      <th>147</th>
      <td>6.5</td>
      <td>3.0</td>
      <td>5.2</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>146</th>
      <td>6.3</td>
      <td>2.5</td>
      <td>5.0</td>
      <td>1.9</td>
    </tr>
    <tr>
      <th>145</th>
      <td>6.7</td>
      <td>3.0</td>
      <td>5.2</td>
      <td>2.3</td>
    </tr>
    <tr>
      <th>144</th>
      <td>6.7</td>
      <td>3.3</td>
      <td>5.7</td>
      <td>2.5</td>
    </tr>
  </tbody>
</table>
</div>




```python
#axis=0 행 인덱스 기준// axis=1 컬럼명 기준 정렬
iris.sort_index(axis=1, ascending=True, inplace =True)
iris.head(6)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>petal length (cm)</th>
      <th>petal width (cm)</th>
      <th>sepal length (cm)</th>
      <th>sepal width (cm)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>149</th>
      <td>5.1</td>
      <td>1.8</td>
      <td>5.9</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>148</th>
      <td>5.4</td>
      <td>2.3</td>
      <td>6.2</td>
      <td>3.4</td>
    </tr>
    <tr>
      <th>147</th>
      <td>5.2</td>
      <td>2.0</td>
      <td>6.5</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>146</th>
      <td>5.0</td>
      <td>1.9</td>
      <td>6.3</td>
      <td>2.5</td>
    </tr>
    <tr>
      <th>145</th>
      <td>5.2</td>
      <td>2.3</td>
      <td>6.7</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>144</th>
      <td>5.7</td>
      <td>2.5</td>
      <td>6.7</td>
      <td>3.3</td>
    </tr>
  </tbody>
</table>
</div>




```python
#값 기준 정렬 시 기준컬럼 반드시 설정
iris.sort_values('petal length (cm)')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>petal length (cm)</th>
      <th>petal width (cm)</th>
      <th>sepal length (cm)</th>
      <th>sepal width (cm)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>22</th>
      <td>1.0</td>
      <td>0.2</td>
      <td>4.6</td>
      <td>3.6</td>
    </tr>
    <tr>
      <th>13</th>
      <td>1.1</td>
      <td>0.1</td>
      <td>4.3</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>1.2</td>
      <td>0.2</td>
      <td>5.8</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>35</th>
      <td>1.2</td>
      <td>0.2</td>
      <td>5.0</td>
      <td>3.2</td>
    </tr>
    <tr>
      <th>16</th>
      <td>1.3</td>
      <td>0.4</td>
      <td>5.4</td>
      <td>3.9</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>131</th>
      <td>6.4</td>
      <td>2.0</td>
      <td>7.9</td>
      <td>3.8</td>
    </tr>
    <tr>
      <th>105</th>
      <td>6.6</td>
      <td>2.1</td>
      <td>7.6</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>117</th>
      <td>6.7</td>
      <td>2.2</td>
      <td>7.7</td>
      <td>3.8</td>
    </tr>
    <tr>
      <th>122</th>
      <td>6.7</td>
      <td>2.0</td>
      <td>7.7</td>
      <td>2.8</td>
    </tr>
    <tr>
      <th>118</th>
      <td>6.9</td>
      <td>2.3</td>
      <td>7.7</td>
      <td>2.6</td>
    </tr>
  </tbody>
</table>
<p>150 rows × 4 columns</p>
</div>




```python
iris.sort_values(['petal width (cm)', 'sepal length (cm)'])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>petal length (cm)</th>
      <th>petal width (cm)</th>
      <th>sepal length (cm)</th>
      <th>sepal width (cm)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>13</th>
      <td>1.1</td>
      <td>0.1</td>
      <td>4.3</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>1.4</td>
      <td>0.1</td>
      <td>4.8</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>37</th>
      <td>1.4</td>
      <td>0.1</td>
      <td>4.9</td>
      <td>3.6</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1.5</td>
      <td>0.1</td>
      <td>4.9</td>
      <td>3.1</td>
    </tr>
    <tr>
      <th>32</th>
      <td>1.5</td>
      <td>0.1</td>
      <td>5.2</td>
      <td>4.1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>136</th>
      <td>5.6</td>
      <td>2.4</td>
      <td>6.3</td>
      <td>3.4</td>
    </tr>
    <tr>
      <th>140</th>
      <td>5.6</td>
      <td>2.4</td>
      <td>6.7</td>
      <td>3.1</td>
    </tr>
    <tr>
      <th>100</th>
      <td>6.0</td>
      <td>2.5</td>
      <td>6.3</td>
      <td>3.3</td>
    </tr>
    <tr>
      <th>144</th>
      <td>5.7</td>
      <td>2.5</td>
      <td>6.7</td>
      <td>3.3</td>
    </tr>
    <tr>
      <th>109</th>
      <td>6.1</td>
      <td>2.5</td>
      <td>7.2</td>
      <td>3.6</td>
    </tr>
  </tbody>
</table>
<p>150 rows × 4 columns</p>
</div>



### 6절 데이터 결합


```python
#단순 연결 - concat, append
#pandas.concat(objs, axis=0, ignore_index=False)
#objs: 객체리스트 (DF, Series, Panel 모두 가능)
#axis=0 행끼리 합침, 열방향으로 결합, axs=1 열끼리 합침, 행 방향으로 결합
#ignore_index = True면 기존 무시하고 0부터 시작하는 정수로 재설정함
```


```python
HR1 = pd.DataFrame({'이름':['장화','홍련'],
                   '부서':['영업','회계'],
                   '직급':['팀장','사원']})
HR2= pd.DataFrame({'이름':['콩쥐','팥쥐'],
                  '직급':['사원','팀장'],
                  '부서':['영업','인사']})
pd.concat([HR1,HR2], axis=0)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>이름</th>
      <th>부서</th>
      <th>직급</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>장화</td>
      <td>영업</td>
      <td>팀장</td>
    </tr>
    <tr>
      <th>1</th>
      <td>홍련</td>
      <td>회계</td>
      <td>사원</td>
    </tr>
    <tr>
      <th>0</th>
      <td>콩쥐</td>
      <td>영업</td>
      <td>사원</td>
    </tr>
    <tr>
      <th>1</th>
      <td>팥쥐</td>
      <td>인사</td>
      <td>팀장</td>
    </tr>
  </tbody>
</table>
</div>




```python
HR3 = pd.DataFrame({'이름':['콩쥐','팥쥐'],
                   '부서':['영업','인사'],
                   '급여':[3500, 2800]})
pd.concat([HR1,HR3], axis=0, ignore_index=True)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>이름</th>
      <th>부서</th>
      <th>직급</th>
      <th>급여</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>장화</td>
      <td>영업</td>
      <td>팀장</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>홍련</td>
      <td>회계</td>
      <td>사원</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>콩쥐</td>
      <td>영업</td>
      <td>NaN</td>
      <td>3500.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>팥쥐</td>
      <td>인사</td>
      <td>NaN</td>
      <td>2800.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
#행방향
HR4 = pd.Series({1:2500}, name='급여')
pd.concat([HR1,HR4], axis=1)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>이름</th>
      <th>부서</th>
      <th>직급</th>
      <th>급여</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>장화</td>
      <td>영업</td>
      <td>팀장</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>홍련</td>
      <td>회계</td>
      <td>사원</td>
      <td>2500.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
#조인 join, merge
#join - inner(교집합) outer(합집합) left(기준 데이터위주) right(대상 데이터위주)

#merge
#DataFrame.merge(right, how='inner', on= key컬럼이름(같은경우), left_on=, right_on= (다른경우), left_index=False, sort=False, suffixes=('_x','_y'))
#left_index 왼/오른쪽 df의 인덱스를 key로 사용할경우
#sort 키값을 기준으로 정렬할지 여부
#suffixes 왼/오른 df 컬럼명에 사용할 접미사
```


```python
#교집합
product = pd.DataFrame({'상품코드':['G1','G2','G3','G4'],
                      '상품명': ['우유','감자','빵','치킨']})
sale = pd.DataFrame({'주문번호':[1001,1002,1002,1003,1004],
                  '상품코드':['G4','G3','G1','G3','G5'],
                  '주문수량':[1,4,2,2,3]})
sale.merge(product, on ='상품코드', how ='inner')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>주문번호</th>
      <th>상품코드</th>
      <th>주문수량</th>
      <th>상품명</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1001</td>
      <td>G4</td>
      <td>1</td>
      <td>치킨</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1002</td>
      <td>G3</td>
      <td>4</td>
      <td>빵</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1003</td>
      <td>G3</td>
      <td>2</td>
      <td>빵</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1002</td>
      <td>G1</td>
      <td>2</td>
      <td>우유</td>
    </tr>
  </tbody>
</table>
</div>




```python
#합집합
sale.merge(product, on = '상품코드', how='outer', sort=True)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>주문번호</th>
      <th>상품코드</th>
      <th>주문수량</th>
      <th>상품명</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1002.0</td>
      <td>G1</td>
      <td>2.0</td>
      <td>우유</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>G2</td>
      <td>NaN</td>
      <td>감자</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1002.0</td>
      <td>G3</td>
      <td>4.0</td>
      <td>빵</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1003.0</td>
      <td>G3</td>
      <td>2.0</td>
      <td>빵</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1001.0</td>
      <td>G4</td>
      <td>1.0</td>
      <td>치킨</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1004.0</td>
      <td>G5</td>
      <td>3.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
#left join - 기준데이터 모두 포함
sale.merge(product, left_on='상품코드', right_on='상품코드', how='left')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>주문번호</th>
      <th>상품코드</th>
      <th>주문수량</th>
      <th>상품명</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1001</td>
      <td>G4</td>
      <td>1</td>
      <td>치킨</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1002</td>
      <td>G3</td>
      <td>4</td>
      <td>빵</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1002</td>
      <td>G1</td>
      <td>2</td>
      <td>우유</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1003</td>
      <td>G3</td>
      <td>2</td>
      <td>빵</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1004</td>
      <td>G5</td>
      <td>3</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>



### 7절 데이터 요약


```python
#그룹화
#DataFrame.groupby(by=None, axis=0, level=None, as_index=True, sort=False, dropna=True).FUN()
#FUN 집계함수
#level 축이 계층구조일때 특정수준을 기준으로그룹화
#as_index 그룹레이블을 인덱스로 출력할지 여부
```


```python
#집계함수
#count, sum, min, max, mean, median, std, var, quantile(n) 분위수, first, last, describe 기술통계량
```


```python
IRIS = load_iris()
iris['class'] = IRIS.target
iris['class'] = iris['class'].map({0:'setosa', 1:'versicolor', 2: 'virginica'})
iris.groupby(by='class').mean()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>petal length (cm)</th>
      <th>petal width (cm)</th>
      <th>sepal length (cm)</th>
      <th>sepal width (cm)</th>
    </tr>
    <tr>
      <th>class</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>setosa</th>
      <td>5.552</td>
      <td>2.026</td>
      <td>6.588</td>
      <td>2.974</td>
    </tr>
    <tr>
      <th>versicolor</th>
      <td>4.260</td>
      <td>1.326</td>
      <td>5.936</td>
      <td>2.770</td>
    </tr>
    <tr>
      <th>virginica</th>
      <td>1.462</td>
      <td>0.246</td>
      <td>5.006</td>
      <td>3.428</td>
    </tr>
  </tbody>
</table>
</div>




```python
iris.groupby(by='class').median()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>petal length (cm)</th>
      <th>petal width (cm)</th>
      <th>sepal length (cm)</th>
      <th>sepal width (cm)</th>
    </tr>
    <tr>
      <th>class</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>setosa</th>
      <td>5.55</td>
      <td>2.0</td>
      <td>6.5</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>versicolor</th>
      <td>4.35</td>
      <td>1.3</td>
      <td>5.9</td>
      <td>2.8</td>
    </tr>
    <tr>
      <th>virginica</th>
      <td>1.50</td>
      <td>0.2</td>
      <td>5.0</td>
      <td>3.4</td>
    </tr>
  </tbody>
</table>
</div>




```python
#도수분포표
#히스토그램: 도수분포표를 그래프로..
pd.Series(iris['class']).value_counts()
```




    versicolor    50
    setosa        50
    virginica     50
    Name: class, dtype: int64




```python
#3개 구간으로 나누어 컬럼생성
iris['petal width level'] = pd.qcut(iris['petal width (cm)'], q=3, labels =['short', 'middle', 'long'])
pd.Series(iris['petal width level']).value_counts().to_frame()
#to_frame함수 - 프레임으로..
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>petal width level</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>middle</th>
      <td>52</td>
    </tr>
    <tr>
      <th>short</th>
      <td>50</td>
    </tr>
    <tr>
      <th>long</th>
      <td>48</td>
    </tr>
  </tbody>
</table>
</div>




```python
#두개 기준에 따른 분포 확인- crosstab
#pd.crosstab(index, columns, dropna=True, normalize=False)
#normailize: 'all', True이면 모든값 // 'index'이면 각 행 // 'columns'이면 각 열에 대해 정규화
```


```python
pd.crosstab(iris['petal width level'], iris['class'])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>class</th>
      <th>setosa</th>
      <th>versicolor</th>
      <th>virginica</th>
    </tr>
    <tr>
      <th>petal width level</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>short</th>
      <td>0</td>
      <td>0</td>
      <td>50</td>
    </tr>
    <tr>
      <th>middle</th>
      <td>4</td>
      <td>48</td>
      <td>0</td>
    </tr>
    <tr>
      <th>long</th>
      <td>46</td>
      <td>2</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>



### 8절 데이터 재구조화


```python
#피벗테이블 
#df.pivot_table(index=None, columns=None, values=None, aggfunc='mean')
#index 인덱스가 될 컬럼 이름
#columns 컬럼으로 분리할 컬럼명 (범주형 변수)
#aggfunc 집계함수 사용할 경우
```


```python
score = {'학년':[1,1,1,1,2,2],
        '반':['A','A','B','B','C','C'],
        '성별':['여','남','여','남','여','남'],
        '성적':[76,88,85,72,68,70]}
score = pd.DataFrame(score)
score
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>학년</th>
      <th>반</th>
      <th>성별</th>
      <th>성적</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>A</td>
      <td>여</td>
      <td>76</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>A</td>
      <td>남</td>
      <td>88</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>B</td>
      <td>여</td>
      <td>85</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>B</td>
      <td>남</td>
      <td>72</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2</td>
      <td>C</td>
      <td>여</td>
      <td>68</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2</td>
      <td>C</td>
      <td>남</td>
      <td>70</td>
    </tr>
  </tbody>
</table>
</div>




```python
score = score.pivot_table(index=['학년','반'],
                         columns='성별', values='성적')
score
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>성별</th>
      <th>남</th>
      <th>여</th>
    </tr>
    <tr>
      <th>학년</th>
      <th>반</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">1</th>
      <th>A</th>
      <td>88</td>
      <td>76</td>
    </tr>
    <tr>
      <th>B</th>
      <td>72</td>
      <td>85</td>
    </tr>
    <tr>
      <th>2</th>
      <th>C</th>
      <td>70</td>
      <td>68</td>
    </tr>
  </tbody>
</table>
</div>




```python
# Melt - 피벗테이블의 반대
#df.melt(id_vars=None, var_name=None, value_name=None)
#id_vars: 인덱스컬럼명, var_name: variable변수 이름, value_name: value변수 이름
```


```python
score.reset_index().melt(id_vars=['학년','반'], var_name='성별', value_name='성적')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>학년</th>
      <th>반</th>
      <th>성별</th>
      <th>성적</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>A</td>
      <td>남</td>
      <td>88</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>B</td>
      <td>남</td>
      <td>72</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>C</td>
      <td>남</td>
      <td>70</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>A</td>
      <td>여</td>
      <td>76</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>B</td>
      <td>여</td>
      <td>85</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2</td>
      <td>C</td>
      <td>여</td>
      <td>68</td>
    </tr>
  </tbody>
</table>
</div>



### 9절 데이터프레임에 함수 적용


```python
# Apply - 행/열 방향 자유롭게 함수를 적용
score.apply(np.sqrt, axis=0)
# np.sqrt - Return the non-negative square-root of an array,
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>성별</th>
      <th>남</th>
      <th>여</th>
    </tr>
    <tr>
      <th>학년</th>
      <th>반</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">1</th>
      <th>A</th>
      <td>9.380832</td>
      <td>8.717798</td>
    </tr>
    <tr>
      <th>B</th>
      <td>8.485281</td>
      <td>9.219544</td>
    </tr>
    <tr>
      <th>2</th>
      <th>C</th>
      <td>8.366600</td>
      <td>8.246211</td>
    </tr>
  </tbody>
</table>
</div>




```python
score.apply(np.max, axis = 0)
```




    성별
    남    88
    여    85
    dtype: int64




```python
#함수 직접 정의하기
def plus_five(val):
    return val+5
score.apply(plus_five)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>성별</th>
      <th>남</th>
      <th>여</th>
    </tr>
    <tr>
      <th>학년</th>
      <th>반</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">1</th>
      <th>A</th>
      <td>93</td>
      <td>81</td>
    </tr>
    <tr>
      <th>B</th>
      <td>77</td>
      <td>90</td>
    </tr>
    <tr>
      <th>2</th>
      <th>C</th>
      <td>75</td>
      <td>73</td>
    </tr>
  </tbody>
</table>
</div>




```python
from math import ceil

def class_avg(df):
    return ceil((df['남'] + df['여'])/2)
score.apply(class_avg, axis = 1)
#ceil function -소수점 값이 있는 경우 무조건 올려서 다음 정수 값을 반환
```




    학년  반
    1   A    82
        B    79
    2   C    69
    dtype: int64




```python
#데이터 타입 확인
print(type(score))
```

    <class 'pandas.core.frame.DataFrame'>
    


```python
score.info()
```

    <class 'pandas.core.frame.DataFrame'>
    MultiIndex: 3 entries, (1, 'A') to (2, 'C')
    Data columns (total 2 columns):
     #   Column  Non-Null Count  Dtype
    ---  ------  --------------  -----
     0   남       3 non-null      int64
     1   여       3 non-null      int64
    dtypes: int64(2)
    memory usage: 328.0+ bytes
    


```python
#'남'컬럼만 series로 변경
s_score = score['남'].squeeze()
print(type(s_score))
```

    <class 'pandas.core.series.Series'>
    


```python
# Map - map(lambda)사용 시 series 형식 데이터여야함
score['남'].map(lambda x: x+5)
```




    학년  반
    1   A    93
        B    77
    2   C    75
    Name: 남, dtype: int64



### 10절 문자열 데이터 변환


```python
#인덱싱 - str()은 df아닌 series속성이므로 컬럼을 선택해줘야함
landmark = pd.DataFrame({'name':['광화문','호미곶','첨성대'],
                        'location':['서울 종로구 사직로 161',
                                   '경북 포항시 남구 호미곶면 대보리 150',
                                   '경북 경주시 인왕동 839-1']})
landmark['location'].str[3:6]
#4~6번째 글자 추출
```




    0    종로구
    1    포항시
    2    경주시
    Name: location, dtype: object




```python
#분할 - 특정 문자열 기준 하나의 컬럼을 여러개로 분할
#expand=True 분할된 문자열을 별도 열로 확장
landmark['location'].str.split(" ", expand = True)
#빈칸으로 구분하기
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>서울</td>
      <td>종로구</td>
      <td>사직로</td>
      <td>161</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>1</th>
      <td>경북</td>
      <td>포항시</td>
      <td>남구</td>
      <td>호미곶면</td>
      <td>대보리</td>
      <td>150</td>
    </tr>
    <tr>
      <th>2</th>
      <td>경북</td>
      <td>경주시</td>
      <td>인왕동</td>
      <td>839-1</td>
      <td>None</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
</div>




```python
landmark['loc_1'] = landmark['location'].str.split(" ").str[0]
landmark
#빈칸으로 분할 후 다시 0번째 추출
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>location</th>
      <th>loc_1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>광화문</td>
      <td>서울 종로구 사직로 161</td>
      <td>서울</td>
    </tr>
    <tr>
      <th>1</th>
      <td>호미곶</td>
      <td>경북 포항시 남구 호미곶면 대보리 150</td>
      <td>경북</td>
    </tr>
    <tr>
      <th>2</th>
      <td>첨성대</td>
      <td>경북 경주시 인왕동 839-1</td>
      <td>경북</td>
    </tr>
  </tbody>
</table>
</div>




```python
#탐색 - boolean타입 값으로 출력
landmark['location'].str.startswith('서울')
```




    0     True
    1    False
    2    False
    Name: location, dtype: bool




```python
landmark['location'].str.endswith('1')
```




    0     True
    1    False
    2     True
    Name: location, dtype: bool




```python
landmark['location'].str.contains('1')
```




    0    True
    1    True
    2    True
    Name: location, dtype: bool



### 11절 날짜 데이터 핸들링


```python
#현재 날짜
from datetime import datetime
datetime.today()
```




    datetime.datetime(2022, 6, 13, 20, 8, 34, 458309)




```python
datetime.today().year
```




    2022




```python
#날짜 형식 변환
# pandas에서 to_datetime()
# df['Datetime'] = pd.to_datetime(df['Datetime'].format = "%Y-%M-%d %H:%M:%S")
```


```python
# 문자열 -> 날짜형식으로 :  strptime()
datetime.strptime('2022-01-01 00:00:00', '%Y-%m-%d %H:%M:%S')
```




    datetime.datetime(2022, 1, 1, 0, 0)




```python
# 날짜형식 -> 문자열 : strftime()
time = datetime.today()
time.strftime('%Y-%m-%d %H:%M:%S')
```




    '2022-06-13 20:15:40'




```python
#날짜 연산 - timedelta()
from datetime import timedelta
time = datetime.today()
time + timedelta(days=100)
#days, seconds, microseconds, milliseconds, minutes, hours, weeks= 
```




    datetime.datetime(2022, 9, 21, 20, 18, 13, 510247)


